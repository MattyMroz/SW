#include"stm32l4xx_hal.h"#ifdefined(DMAMUX1)#ifdefHAL_DMA_MODULE_ENABLEDHAL_StatusTypeDefHAL_DMAEx_ConfigMuxSync(DMA_HandleTypeDef*hdma,HAL_DMA_MuxSyncConfigTypeDef*pSyncConfig){assert_param(IS_DMA_ALL_INSTANCE(hdma->Instance));assert_param(IS_DMAMUX_SYNC_SIGNAL_ID(pSyncConfig->SyncSignalID));assert_param(IS_DMAMUX_SYNC_POLARITY(pSyncConfig->SyncPolarity));assert_param(IS_DMAMUX_SYNC_STATE(pSyncConfig->SyncEnable));assert_param(IS_DMAMUX_SYNC_EVENT(pSyncConfig->EventEnable));assert_param(IS_DMAMUX_SYNC_REQUEST_NUMBER(pSyncConfig->RequestNumber));if(hdma->State==HAL_DMA_STATE_READY){__HAL_LOCK(hdma);MODIFY_REG(hdma->DMAmuxChannel->CCR,\(~DMAMUX_CxCR_DMAREQ_ID),\((pSyncConfig->SyncSignalID)<<DMAMUX_CxCR_SYNC_ID_Pos)|((pSyncConfig->RequestNumber-1U)<<DMAMUX_CxCR_NBREQ_Pos)|\pSyncConfig->SyncPolarity|((uint32_t)pSyncConfig->SyncEnable<<DMAMUX_CxCR_SE_Pos)|\((uint32_t)pSyncConfig->EventEnable<<DMAMUX_CxCR_EGE_Pos));__HAL_UNLOCK(hdma);returnHAL_OK;}else{returnHAL_ERROR;}}HAL_StatusTypeDefHAL_DMAEx_ConfigMuxRequestGenerator(DMA_HandleTypeDef*hdma,HAL_DMA_MuxRequestGeneratorConfigTypeDef*pRequestGeneratorConfig){assert_param(IS_DMA_ALL_INSTANCE(hdma->Instance));assert_param(IS_DMAMUX_REQUEST_GEN_SIGNAL_ID(pRequestGeneratorConfig->SignalID));assert_param(IS_DMAMUX_REQUEST_GEN_POLARITY(pRequestGeneratorConfig->Polarity));assert_param(IS_DMAMUX_REQUEST_GEN_REQUEST_NUMBER(pRequestGeneratorConfig->RequestNumber));if((hdma->State==HAL_DMA_STATE_READY)&&(hdma->DMAmuxRequestGen!=0U)){__HAL_LOCK(hdma);hdma->DMAmuxRequestGen->RGCR=pRequestGeneratorConfig->SignalID|\((pRequestGeneratorConfig->RequestNumber-1U)<<DMAMUX_RGxCR_GNBREQ_Pos)|\pRequestGeneratorConfig->Polarity;__HAL_UNLOCK(hdma);returnHAL_OK;}else{returnHAL_ERROR;}}HAL_StatusTypeDefHAL_DMAEx_EnableMuxRequestGenerator(DMA_HandleTypeDef*hdma){assert_param(IS_DMA_ALL_INSTANCE(hdma->Instance));if((hdma->State!=HAL_DMA_STATE_RESET)&&(hdma->DMAmuxRequestGen!=0)){hdma->DMAmuxRequestGen->RGCR|=DMAMUX_RGxCR_GE;returnHAL_OK;}else{returnHAL_ERROR;}}HAL_StatusTypeDefHAL_DMAEx_DisableMuxRequestGenerator(DMA_HandleTypeDef*hdma){assert_param(IS_DMA_ALL_INSTANCE(hdma->Instance));if((hdma->State!=HAL_DMA_STATE_RESET)&&(hdma->DMAmuxRequestGen!=0)){hdma->DMAmuxRequestGen->RGCR&=~DMAMUX_RGxCR_GE;returnHAL_OK;}else{returnHAL_ERROR;}}voidHAL_DMAEx_MUX_IRQHandler(DMA_HandleTypeDef*hdma){if((hdma->DMAmuxChannelStatus->CSR&hdma->DMAmuxChannelStatusMask)!=0U){hdma->DMAmuxChannel->CCR&=~DMAMUX_CxCR_SOIE;hdma->DMAmuxChannelStatus->CFR=hdma->DMAmuxChannelStatusMask;hdma->ErrorCode|=HAL_DMA_ERROR_SYNC;if(hdma->XferErrorCallback!=NULL){hdma->XferErrorCallback(hdma);}}if(hdma->DMAmuxRequestGen!=0){if((hdma->DMAmuxRequestGenStatus->RGSR&hdma->DMAmuxRequestGenStatusMask)!=0U){hdma->DMAmuxRequestGen->RGCR&=~DMAMUX_RGxCR_OIE;hdma->DMAmuxRequestGenStatus->RGCFR=hdma->DMAmuxRequestGenStatusMask;hdma->ErrorCode|=HAL_DMA_ERROR_REQGEN;if(hdma->XferErrorCallback!=NULL){hdma->XferErrorCallback(hdma);}}}}#endif#endif